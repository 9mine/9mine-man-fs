<action name=ATTACH(5)>ATTACH(5)</action>                                               <action name=ATTACH(5)>ATTACH(5)</action>

NAME
<style color=#00ffffff size=1>.</style>            attach, auth - messages to establish a connection

SYNOPSIS
<style color=#00ffffff size=1>.</style>            size\[4\] Tauth tag\[2\] afid\[4\] uname\[s\] aname\[s\]
<style color=#00ffffff size=1>.</style>            size\[4\] Rauth tag\[2\] aqid\[13\]

<style color=#00ffffff size=1>.</style>            size\[4\] Tattach tag\[2\] fid\[4\] afid\[4\] uname\[s\] aname\[s\]
<style color=#00ffffff size=1>.</style>            size\[4\] Rattach tag\[2\] qid\[13\]

DESCRIPTION
<style color=#00ffffff size=1>.</style>            The attach message serves as a fresh introduction from a
<style color=#00ffffff size=1>.</style>            user on the client machine to the server. The message
<style color=#00ffffff size=1>.</style>            identifies the user (uname) and may select the file tree to
<style color=#00ffffff size=1>.</style>            access (aname). The afid argument specifies a fid previously
<style color=#00ffffff size=1>.</style>            established by an auth message, as described below.

<style color=#00ffffff size=1>.</style>            As a result of the attach transaction, the client will have
<style color=#00ffffff size=1>.</style>            a connection to the root directory of the desired file tree,
<style color=#00ffffff size=1>.</style>            represented by fid. An error is returned if fid is already
<style color=#00ffffff size=1>.</style>            in use. The server's idea of the root of the file tree is
<style color=#00ffffff size=1>.</style>            represented by the returned qid.

<style color=#00ffffff size=1>.</style>            If the client does not wish to authenticate the connection,
<style color=#00ffffff size=1>.</style>            or knows that authentication is not required, the afid field
<style color=#00ffffff size=1>.</style>            in the attach message should be set to NOFID, defined as
<style color=#00ffffff size=1>.</style>            (u32int)~0 in <fcall.h>. If the client does wish to
<style color=#00ffffff size=1>.</style>            authenticate, it must acquire and validate an afid using an
<style color=#00ffffff size=1>.</style>            auth message before doing the attach.

<style color=#00ffffff size=1>.</style>            The auth message contains afid, a new fid to be established
<style color=#00ffffff size=1>.</style>            for authentication, and the uname and aname that will be
<style color=#00ffffff size=1>.</style>            those of the following attach message. If the server does
<style color=#00ffffff size=1>.</style>            not require authentication, it returns Rerror to the Tauth
<style color=#00ffffff size=1>.</style>            message.

<style color=#00ffffff size=1>.</style>            If the server does require authentication, it returns aqid
<style color=#00ffffff size=1>.</style>            defining a file of type QTAUTH (see <action name=intro(5)>intro(5)</action>) that may be
<style color=#00ffffff size=1>.</style>            read and written (using read and write messages in the usual
<style color=#00ffffff size=1>.</style>            way) to execute an authentication protocol. That protocol's
<style color=#00ffffff size=1>.</style>            definition is not part of 9P itself.

<style color=#00ffffff size=1>.</style>            Once the protocol is complete, the same afid is presented in
<style color=#00ffffff size=1>.</style>            the attach message for the user, granting entry. The same
<style color=#00ffffff size=1>.</style>            validated afid may be used for multiple attach messages with
<style color=#00ffffff size=1>.</style>            the same uname and aname.

ENTRY POINTS
<style color=#00ffffff size=1>.</style>            An attach transaction will be generated for kernel devices
<style color=#00ffffff size=1>.</style>            (see <action name=intro(3)>intro(3)</action>) when a system call evaluates a file name
<style color=#00ffffff size=1>.</style>            beginning with `#'. <action name=Sys-pipe(2)>Sys-pipe(2)</action> generates an attach on the
<style color=#00ffffff size=1>.</style>            kernel device <action name=pipe(3)>pipe(3)</action>. The mount call (see <action name=sys-bind(2)>sys-bind(2)</action>)
<style color=#00ffffff size=1>.</style>            generates an attach message to the remote file server. When
<style color=#00ffffff size=1>.</style>            the kernel boots, an attach is made to the root device, root
<style color=#00ffffff size=1>.</style>            (3), and then an attach is made to the requested file server
<style color=#00ffffff size=1>.</style>            machine.

<style color=#00ffffff size=1>.</style>            An auth transaction is generated by the <action name=sys-fauth(2)>sys-fauth(2)</action> system
<style color=#00ffffff size=1>.</style>            call or by the first mount system call on an uninitialized
<style color=#00ffffff size=1>.</style>            connection.

SEE ALSO
<style color=#00ffffff size=1>.</style>            <action name=sys-bind(2)>sys-bind(2)</action>, <action name=sys-fauth(2)>sys-fauth(2)</action>, <action name=intro(3)>intro(3)</action>, <action name=root(3)>root(3)</action>, <action name=version(5)>version(5)</action>

<style color=#00ffffff size=1>.</style>                                Inferno Manual
